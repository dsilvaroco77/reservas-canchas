<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserva de Canchas de Tenis UCT v2.0</title>
    
    <script src="https://cdn.lordicon.com/lordicon.js"></script>

    <style>
        :root {
            --background-color: #111;
            --text-color: #f5f5f7;
            --subtle-text-color: #a1a1a6;
            --accent-color: #007aff;
            --card-background: rgba(35, 35, 35, 0.5);
            --glass-background: rgba(30, 30, 30, 0.75);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            animation: fadeIn 1s ease-out forwards;
        }

        header { text-align: center; margin-bottom: 60px; }
        header h1 { font-size: 48px; font-weight: 700; margin: 0; letter-spacing: -1px; }
        header .date-today { font-size: 18px; color: var(--subtle-text-color); font-weight: 500; margin-top: 8px; }

        .complex-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 30px; margin-bottom: 60px; }

        .complex-card {
            background-size: cover;
            background-position: center;
            border-radius: 24px;
            padding: 30px;
            min-height: 450px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.4s ease;
        }
        
        /* --- NUEVO: Efecto de brillo en hover --- */
        .complex-card::after {
            content: "";
            position: absolute;
            top: 0;
            left: -150%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s ease;
        }
        .complex-card:hover { transform: scale(1.03); }
        .complex-card:hover::after { left: 150%; }

        .complex-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.2) 60%, transparent 100%);
            z-index: 1;
        }
        .complex-card > * { position: relative; z-index: 2; }
        
        .card-content h2 { font-size: 32px; font-weight: 700; margin: 0; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .card-content p { font-size: 18px; font-weight: 500; margin: 5px 0 0; color: rgba(255, 255, 255, 0.85); text-shadow: 0 2px 5px rgba(0,0,0,0.5); }
        
        .buttons { display: flex; gap: 15px; flex-wrap: wrap; }
        .calendar-button { background-color: var(--glass-background); color: white; font-size: 16px; font-weight: 600; padding: 12px 24px; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 30px; cursor: pointer; text-decoration: none; text-align: center; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); transition: background-color 0.3s ease, transform 0.2s ease; }
        .calendar-button:hover { background-color: rgba(255, 255, 255, 0.2); transform: translateY(-2px); }

        .info-section { background-color: var(--card-background); border-radius: 24px; padding: 30px; margin-bottom: 60px; }
        .section-title { font-size: 28px; font-weight: 600; margin-top: 0; margin-bottom: 5px; color: var(--text-color); }

        /* --- NUEVO: Estilos para la sugerencia inteligente --- */
        .smart-suggestion { font-size: 16px; color: var(--accent-color); font-weight: 500; margin-bottom: 25px; min-height: 24px;}

        .forecast-container { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 20px; }
        .forecast-container::-webkit-scrollbar { display: none; }
        .forecast-container { -ms-overflow-style: none; scrollbar-width: none; }
        
        .forecast-day, .forecast-hour {
            flex: 0 0 110px;
            background: var(--glass-background);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            padding: 15px;
            text-align: center;
            color: var(--text-color);
            transition: background-color 0.3s ease;
        }
        .forecast-day:hover, .forecast-hour:hover { background-color: rgba(255, 255, 255, 0.1); }
        
        .forecast-day span, .forecast-hour span { display: block; font-size: 14px; font-weight: 500; }
        .forecast-day .day-name, .forecast-hour .hour-name { color: var(--subtle-text-color); font-weight: 600; }
        .weather-icon { width: 48px; height: 48px; margin: 4px auto; } /* Lordicon size */
        .forecast-day .temp { font-size: 12px; color: var(--subtle-text-color); }
        .forecast-day .rain { margin-top: 8px; font-size: 13px; font-weight: 600; color: var(--accent-color); }

        footer { text-align: center; padding: 0 20px 40px; color: var(--subtle-text-color); }
        .tennis-message { font-size: 22px; font-style: italic; max-width: 700px; margin: 0 auto 30px; line-height: 1.5; }
        .footer-links a { color: var(--subtle-text-color); background-color: var(--card-background); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 10px 20px; text-decoration: none; margin: 0 10px; transition: color 0.3s, background-color 0.3s; }
        .footer-links a:hover { background-color: var(--accent-color); color: white; border-color: var(--accent-color); }
        .small-note { margin-top: 30px; font-size: 14px; max-width: 600px; margin-left: auto; margin-right: auto; line-height: 1.6; }
        
        @media (max-width: 768px) {
            .main-container { padding: 20px 15px; }
            header { margin-bottom: 40px; }
            header h1 { font-size: 36px; }
            header .date-today { font-size: 16px; }
            .complex-grid { gap: 20px; }
            .complex-card { padding: 25px; min-height: 400px; }
            .card-content h2 { font-size: 28px; }
            .card-content p { font-size: 16px; }
            .info-section { padding: 25px; }
            .section-title { font-size: 24px; }
            .tennis-message { font-size: 18px; }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <header>
            <h1>Canchas de Tenis UCT</h1>
            <div class="date-today" id="dateToday"></div>
        </header>

        <main>
            <div class="complex-grid">
                <article class="complex-card" style="background-image: url('cec.jpg');">
                    <div class="card-content"><h2>Complejo CEC</h2><p>Canchas de Arcilla</p></div>
                    <div class="buttons">
                        <a href="https://calendar.google.com/calendar/appointments/schedules/AcZssZ1pS98lJc9AnurRJsrrFELO8p7lFqT8SE5tpaJPiVixBHN83PpSWM4oqIfom2EAtwcVqooJYG7K?gv=true" target="_blank" class="calendar-button">Reservar Cancha 1</a>
                        <a href="https://calendar.google.com/calendar/appointments/schedules/AcZssZ1ijnDghWGh6GVpsD6Q76qxlJqEdDhj9E0MvboyNI_rTAkbn0JfXE3qFoYECfCMjyEPSGpaTRk4?gv=true" target="_blank" class="calendar-button">Reservar Cancha 2</a>
                    </div>
                </article>

                <article class="complex-card" style="background-image: url('cjp.jpg');">
                    <div class="card-content"><h2>Complejo CJP</h2><p>Canchas de Asfalto</p></div>
                    <div class="buttons">
                        <a href="https://calendar.google.com/calendar/appointments/schedules/AcZssZ1GpWHQQiPLKIG7X4TDDUcngRRUAB6Dbo-xM-Ponh2IWTxNwwFnT74l71-bL-toFqDC6b0mAhhu?gv=true" target="_blank" class="calendar-button">Reservar Cancha 1</a>
                        <a href="https://calendar.google.com/calendar/appointments/schedules/AcZssZ23FAuAAPtwBFxJUeCMMAKAQlZTRGMrX3JGA8s3b0Rl9TOj0du1cb6m1cin96U30DfFV03piwMA?gv=true" target="_blank" class="calendar-button">Reservar Cancha 2</a>
                    </div>
                </article>
            </div>

            <section class="info-section">
                <h2 class="section-title">Pronóstico del Tiempo en Temuco</h2>
                <p class="smart-suggestion" id="smartSuggestion">Analizando el mejor momento para jugar...</p>
                <div class="forecast-container" id="dailyForecast"></div>
                <h3 class="section-title" style="margin-top:30px; font-size: 20px;">Próximas Horas</h3>
                <div class="forecast-container" id="hourlyForecast"></div>
            </section>
        </main>
        
        <footer>
            <div class="tennis-message" id="tennisMessage">Generando frase motivacional...</div>
            <div class="footer-links"><a href="normas.html">Normas de Uso</a></div>
            <div class="small-note">Al finalizar el juego en arcilla pasa el escobillón, barre las líneas y riega la cancha para mantenerla en óptimas condiciones. ¡Ocupa los basureros! Solo se permite una reserva diaria por socio. ¡Gracias!</div>
        </footer>
    </div>

    <script>
        const todayElement = document.getElementById('dateToday');
        const today = new Date();
        todayElement.textContent = today.toLocaleDateString('es-ES', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

        const API_KEY_TOMORROW = "ID7bqddtJYbEtDNxshQl9I5xfhJ72Ufb";
        const LAT = -38.7359;
        const LON = -72.5904;

        const members = ["Luis Otth", "Ismael Devia", "Roberto Bermudez", "Roberto Espinoza", "Pablo Lagos", "Francisco Encina", "Gustavo Curaqueo", "Cristian Henriquez", "Cristian Rebolledo", "Sebastián Garrido", "Rodrigo Castro", "Matías Cáceres", "Juan Maripillán", "David Figueroa", "David Silva", "David Fonseca", "Cristian Farias", "Jaime Castillo", "José Baeza", "José Melgarejo", "Miguel Escalona", "Rodrigo Zuñiga", "Francisco Muñoz", "Sebastian Aguilar", "Victor Navarrete", "Cristobal Correa", "Jano Medina", "Miguel Angulo", "Carolina Cárdenas", "Mauricio Matus", "Angélica Encina", "Maria José", "Francisco Mendez", "Violeta Moreno", "Valeria Schatter"];
        const motivationalMessages = ["¡Hoy es tu día para brillar en la cancha!", "No hay nada mejor que el sol para llenarnos de energía. ¡Vamos a jugar!", "El clima está perfecto, no hay excusas. ¡Dale con todo!", "¡Vamos a aprovechar el buen tiempo y mejorar ese revés!", "El sol brilla tanto como tu determinación. ¡A la cancha!", "Un día nublado significa menos calor. ¡Perfecto para entrenar sin parar!", "Hoy el clima está ideal para practicar tus saques. ¡Hazlo valer!", "No hay mejor clima para mejorar tu técnica. ¡Aprovecha!", "El sol está contigo, igual que tu pasión por el tenis. ¡Vamos!", "Nublado pero sin lluvia, ¡una razón más para no detenerse!", "Nada mejor que un día soleado para mostrar de qué estás hecho.", "El clima perfecto para esos rallies largos. ¡Vamos a practicar!", "Con este clima, cada punto cuenta. ¡Vamos con todo!", "Hoy toca darle fuerte, el clima está de nuestro lado.", "Aprovecha este día sin lluvia para dar lo mejor de ti.", "Hoy el sol está para acompañarte a mejorar. ¡A la cancha!", "El clima no podría ser mejor, ¡a aprovechar cada minuto!", "La victoria está en tu mente antes de estar en la cancha.", "El tenis es 90% mental y 10% evitar tropezar con la línea blanca.", "Si pierdes el partido, al menos no pierdas la compostura. Bueno, tal vez un poco.", "¡No culpes a la raqueta! Ella está haciendo lo mejor que puede.", "Hoy no se trata de ganar, se trata de no romper otra cuerda.", "Si no puedes ganar el punto, al menos haz que tu rival sude por él.", "¿Hoy vienes a jugar o a dar un curso de errores no forzados?", "Recuerda, el tenis es como la vida: a veces solo intentas no hacer el ridículo.", "¡Gran saque! Lástima que fue fuera por medio metro.", "Siempre dicen que el esfuerzo lo es todo. Bueno, hoy lo intentaste.", "Tu revés tiene un 50% de probabilidades de ir a la red... optimismo, ¿no?", "Un día sin tenis es un día perdido. ¡A la cancha!", "Con cada golpe, estás más cerca de la perfección. ¡Sigue así!", "Tu mayor rival no está del otro lado de la red, sino en tu mente. ¡Véncelo!", "El clima es perfecto, igual que tu determinación. ¡Dale!", "El éxito es 1% inspiración y 99% transpiración... ¡y hoy toca sudar!", "El tenis es el único deporte donde puedes discutir contigo mismo y perder.", "Si la pelota va hacia ti, ¡corre! Es una pista, no una selfie.", "La raqueta está en tus manos, pero la magia viene del café que tomaste antes.", "Hoy no jugamos para ganar, sino para demostrar que sabemos correr.", "Tu saque es tan rápido que ni tú sabes a dónde va... ¡sorpresa!", "Eres mas malo que el presidente del club.", "cuidado que los mutantes estan ganando todo!", "no robes puntos como Melgarejo!", "tambien fuiste atendido por el \"nana vieja\"?"];

        // --- NUEVO: Mapeo de códigos de clima a iconos animados ---
        function getAnimatedWeatherIcon(weatherCode) {
            const icons = {
                // Soleado / Despejado
                1000: "https://cdn.lordicon.com/skkahier.json", // Sol
                // Parcialmente Nublado
                1100: "https://cdn.lordicon.com/jallping.json", // Sol y Nubes
                1101: "https://cdn.lordicon.com/jallping.json", // Sol y Nubes
                // Mayormente Nublado
                1102: "https://cdn.lordicon.com/veoexymv.json", // Nubes
                // Nublado
                1001: "https://cdn.lordicon.com/veoexymv.json", // Nubes
                // Lluvia Ligera
                4000: "https://cdn.lordicon.com/tblsyeal.json", // Lluvia ligera
                4200: "https://cdn.lordicon.com/tblsyeal.json", // Lluvia ligera
                // Lluvia
                4001: "https://cdn.lordicon.com/fsmqymmv.json", // Lluvia
                // Lluvia Fuerte
                4201: "https://cdn.lordicon.com/fsmqymmv.json", // Lluvia
            };
            return icons[weatherCode] || "https://cdn.lordicon.com/veoexymv.json"; // Icono por defecto (nube)
        }

        function updateMotivationalMessage(dailyData) {
            const tennisMessageElement = document.getElementById('tennisMessage');
            const currentDay = today.getDay(); const currentHour = today.getHours();
            if (currentDay === 0) { tennisMessageElement.textContent = "Las canchas están cerradas los domingos. Aprovecha para descansar y planificar tu próxima semana de juego."; return; }
            const rainProbability = Math.round(dailyData[0].values.precipitationProbability);
            let message = "";
            if (currentHour >= 7 && currentHour <= 23) {
                const randomMember = members[Math.floor(Math.random() * members.length)];
                const randomMessage = motivationalMessages[Math.floor(Math.random() * motivationalMessages.length)];
                if (rainProbability > 70) { message = `${randomMember}, hoy llueve mucho y las canchas no están en condiciones. Es mejor evitar el riesgo de resbalar.`;
                } else { message = `${randomMember}, ${randomMessage}`; }
            } else { message = "Las canchas están cerradas por ahora. ¡Vuelve mañana para más tenis!"; }
            tennisMessageElement.textContent = message;
        }

        async function fetchWeather() {
            const dailyForecastDiv = document.getElementById('dailyForecast');
            const hourlyForecastDiv = document.getElementById('hourlyForecast');
            const suggestionEl = document.getElementById('smartSuggestion');
            
            // --- API Call para ambos pronósticos (diario y por hora) ---
            const URL = `https://api.tomorrow.io/v4/timelines?location=${LAT},${LON}&fields=temperatureMax,temperatureMin,precipitationProbability,weatherCode&timesteps=1d,1h&units=metric&apikey=${API_KEY_TOMORROW}`;

            try {
                const response = await fetch(URL);
                const data = await response.json();
                
                // --- Procesar Pronóstico Diario ---
                const dailyData = data.data.timelines.find(t => t.timestep === '1d').intervals.slice(0, 7);
                dailyForecastDiv.innerHTML = "";
                dailyData.forEach(day => {
                    const date = new Date(day.startTime);
                    const dayString = new Intl.DateTimeFormat('es-ES', { weekday: 'short' }).format(date).replace(/^\w/, c => c.toUpperCase());
                    const iconSrc = getAnimatedWeatherIcon(day.values.weatherCode);
                    dailyForecastDiv.innerHTML += `
                        <div class="forecast-day">
                            <span class="day-name">${dayString}</span>
                            <lord-icon src="${iconSrc}" trigger="hover" colors="primary:#ffffff,secondary:#a1a1a6" class="weather-icon"></lord-icon>
                            <span>${Math.round(day.values.temperatureMax)}°</span>
                            <span class="temp">Min ${Math.round(day.values.temperatureMin)}°</span>
                            <span class="rain">${Math.round(day.values.precipitationProbability)}%</span>
                        </div>`;
                });

                // --- Procesar Pronóstico por Hora (próximas 12 horas) ---
                const hourlyData = data.data.timelines.find(t => t.timestep === '1h').intervals.slice(0, 12);
                hourlyForecastDiv.innerHTML = "";
                let bestTimeFound = false;
                hourlyData.forEach(hour => {
                    const date = new Date(hour.startTime);
                    const hourString = new Intl.DateTimeFormat('es-ES', { hour: '2-digit', minute: '2-digit', hour12: false }).format(date);
                    const iconSrc = getAnimatedWeatherIcon(hour.values.weatherCode);
                    hourlyForecastDiv.innerHTML += `
                        <div class="forecast-hour">
                            <span class="hour-name">${hourString}</span>
                            <lord-icon src="${iconSrc}" trigger="hover" colors="primary:#ffffff,secondary:#a1a1a6" class="weather-icon"></lord-icon>
                            <span>${Math.round(hour.values.temperature)}°</span>
                            <span class="rain">${Math.round(hour.values.precipitationProbability)}%</span>
                        </div>`;

                    // --- NUEVO: Lógica para la sugerencia inteligente ---
                    if (!bestTimeFound && date.getHours() >= 8 && date.getHours() <= 21 && hour.values.precipitationProbability < 15) {
                        suggestionEl.textContent = `Sugerencia: ¡El mejor momento para jugar hoy es alrededor de las ${hourString} hrs!`;
                        bestTimeFound = true;
                    }
                });

                if (!bestTimeFound) { suggestionEl.textContent = "Hoy el clima no acompaña, revisa el pronóstico detallado."; }
                
                updateMotivationalMessage(dailyData);
            } catch (error) {
                console.error("Error fetching weather data:", error);
                suggestionEl.textContent = "No se pudo cargar la información del clima.";
            }
        }
        
        fetchWeather();
        setInterval(fetchWeather, 60 * 60 * 1000); // Actualizar cada hora
    </script>
</body>
</html>
